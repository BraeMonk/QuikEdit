<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=yes">
  <title>Jerry Editor</title>
  <link rel="manifest" href="./manifest.json">
  <link rel="stylesheet" href="./styles.css">
  <meta name="theme-color" content="#1a1a1a">
</head>
<body>
  <div class="editor-container">
    <div class="header">
      <div class="logo">
        Jerry Editor
        <div class="mode-toggle">
          <button class="mode-btn active" data-mode="pixel">Pixel</button>
          <button class="mode-btn" data-mode="sketch">Sketch</button>
        </div>
      </div>
      <div class="header-controls">
        <button class="header-btn" id="newProject" title="New Project (Ctrl+N)">New</button>
        <button class="header-btn" id="saveProject" title="Save Project (Ctrl+S)">Save</button>
        <button class="header-btn" id="exportPNG" title="Export PNG (Ctrl+E)">Export</button>
      </div>
    </div>

    <div class="sidebar">
      <div class="tool-group pixel-tools">
        <div class="tool-btn active" data-tool="pencil" title="Pencil (B)">✏️</div>
        <div class="tool-btn" data-tool="eraser" title="Eraser (E)">🧹</div>
        <div class="tool-btn" data-tool="eyedropper" title="Eyedropper (I)">💧</div>
        <div class="tool-btn" data-tool="fill" title="Fill Bucket (G)">🪣</div>
        
        <div class="tool-separator"></div>
        
        <div class="tool-btn symmetric-tool" data-tool="symmetricPencil" title="Symmetric Pencil (Shift+B)">✏️⚌</div>
        <div class="tool-btn symmetric-tool" data-tool="symmetricEraser" title="Symmetric Eraser (Shift+E)">🧹⚌</div>
        <div class="tool-btn symmetric-tool" data-tool="symmetricFill" title="Symmetric Fill (Shift+G)">🪣⚌</div>
        
        <div class="tool-separator"></div>
        
        <div class="tool-btn" data-tool="select" title="Select (M)">⬚</div>
        <div class="tool-btn" data-tool="move" title="Move (V)">✋</div>
        
        <div class="tool-separator"></div>
        
        <div class="tool-btn" data-tool="line" title="Line (L)">📏</div>
        <div class="tool-btn" data-tool="rect" data-tool-filled="rectFilled" title="Rectangle (R/Shift+R)">▭</div>
        <div class="tool-btn" data-tool="circle" data-tool-filled="circleFilled" title="Circle (O/Shift+O)">○</div>
      </div>

      <div class="tool-group sketch-tools" style="display: none;">
        <div class="tool-btn active" data-tool="brush" title="Brush (B)">🖌️</div>
        <div class="tool-btn" data-tool="pen" title="Pen (P)">✒️</div>
        <div class="tool-btn" data-tool="marker" title="Marker (M)">🖍️</div>
        <div class="tool-btn" data-tool="pencilSketch" title="Pencil (C)">✏️</div>
        <div class="tool-btn" data-tool="charcoal" title="Charcoal (H)">⬛</div>
        
        <div class="tool-separator"></div>
        
        <div class="tool-btn" data-tool="eraser" title="Eraser (E)">🧹</div>
        <div class="tool-btn" data-tool="smudge" title="Smudge (S)">👆</div>
        <div class="tool-btn" data-tool="blur" title="Blur (U)">🌫️</div>
        
        <div class="tool-separator"></div>
        
        <div class="tool-btn" data-tool="lineSketch" title="Line (L)">📏</div>
        <div class="tool-btn" data-tool="rectSketch" title="Rectangle (R/Shift+R)">▭</div>
        <div class="tool-btn" data-tool="circleSketch" title="Circle (O/Shift+O)">○</div>
        <div class="tool-btn" data-tool="sprayPaint" title="Spray Paint (Y)">🎨</div>
      </div>
    </div>

    <div class="canvas-area">
      <div class="canvas-wrapper">
        <div id="canvas" style="display: grid;"></div> 
        <canvas id="sketchCanvas" width="800" height="600" style="display: none;"></canvas>
        <canvas id="selectionOverlay" width="800" height="600" style="position: absolute; top: 0; left: 0; pointer-events: none; display: none;"></canvas>
        <div class="canvas-grid" id="canvasGrid"></div>
      </div>
      <div class="canvas-info" id="canvasInfo">16×16 | Pencil | #000000</div>
      <div class="zoom-indicator" id="zoomIndicator">100%</div>
    </div>

    <div class="panels">
      <div class="panel">
        <div class="panel-header">
          Colors <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group">
            <label>Primary/Secondary Colors</label>
            <div class="control-row">
              <div class="swatch primary" id="primaryColor" style="background: #000000" title="Primary Color (Left Click)"></div>
              <div class="swatch secondary" id="secondaryColor" style="background: #ffffff" title="Secondary Color (Right Click)"></div>
            </div>
          </div>
          
          <div class="control-group">
            <label>Palette</label>
            <select id="paletteSelector"></select>
          </div>
          
          <div class="palette-grid" id="swatches"></div>
          
          <div class="control-group">
            <label>Custom Colors</label>
            <div id="colorPickers" class="palette-grid"></div>
            <button class="btn btn-sm" id="saveCustomPalette">Save Custom Palette</button>
          </div>
        </div>
      </div>

      <div class="panel sketch-controls" style="display: none;">
        <div class="panel-header">
          Brush <span>▼</span>
        </div>
        
        <div class="panel-content">

          <div class="control-group">
            <label>Color</label>
            <input type="color" id="sketchColor" value="#000000">
          </div>
          <div class="control-group">
            <label>Size: <span id="brushSizeLabel">10</span>px</label>
            <input type="range" id="brushSize" min="1" max="100" value="10">
          </div>
          
          <div class="control-group">
            <label>Opacity: <span id="opacityLabel">100</span>%</label>
            <input type="range" id="brushOpacity" min="1" max="100" value="100">
          </div>
          
          <div class="control-group">
            <label>Hardness: <span id="hardnessLabel">100</span>%</label>
            <input type="range" id="brushHardness" min="0" max="100" value="100">
          </div>
          
          <div class="control-group">
            <label>Flow: <span id="flowLabel">100</span>%</label>
            <input type="range" id="brushFlow" min="1" max="100" value="100">
          </div>
          
          <div class="brush-preview" id="brushPreview"></div>
        </div>
      </div>

      <div class="panel pixel-controls">
        <div class="panel-header">
          Symmetry <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group">
            <label>Symmetry Mode</label>
            <div class="btn-group symmetry-controls">
              <button class="btn symmetry-btn active" data-symmetry="none" title="No Symmetry (Q)">None</button>
              <button class="btn symmetry-btn" data-symmetry="horizontal" title="Horizontal Symmetry (W)">─</button>
            </div>
            <div class="btn-group symmetry-controls">
              <button class="btn symmetry-btn" data-symmetry="vertical" title="Vertical Symmetry (A)">│</button>
              <button class="btn symmetry-btn" data-symmetry="both" title="Both Axes (S)">┼</button>
            </div>
          </div>
          <div class="symmetry-info">
            <small id="symmetryInfo">Use symmetric tools (⚌) to draw with active symmetry mode</small>
          </div>
        </div>
      </div>

      <div class="panel pixel-controls">
        <div class="panel-header">
          Transform <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group">
            <label>Rotate</label>
            <div class="btn-group">
              <button class="btn" id="rotateLeft" title="Rotate 90° Left ([)">↶ 90°</button>
              <button class="btn" id="rotate180" title="Rotate 180°">↻ 180°</button>
              <button class="btn" id="rotateRight" title="Rotate 90° Right (])">↷ 90°</button>
            </div>
          </div>
          
          <div class="control-group">
            <label>Flip</label>
            <div class="btn-group">
              <button class="btn" id="flipHorizontal" title="Flip Horizontal (Ctrl+H)">↔ Flip H</button>
              <button class="btn" id="flipVertical" title="Flip Vertical (Ctrl+J)">↕ Flip V</button>
            </div>
          </div>
          
          <div class="transform-info">
            <small>Transforms apply to the current sprite/frame.</small>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header">
          Canvas <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group pixel-controls">
            <label>Size (Pixel)</label>
            <div class="control-row">
              <input type="number" id="canvasWidth" value="16" min="1" max="128">
              <span>×</span>
              <input type="number" id="canvasHeight" value="16" min="1" max="128">
              <button class="btn" id="resizeCanvas">Resize</button>
            </div>
          </div>
          
          <div class="control-group sketch-controls" style="display: none;">
            <label>Canvas Size (Sketch)</label>
            <div class="btn-group">
              <button class="btn" data-size="800x600">800×600</button>
              <button class="btn" data-size="1024x768">1024×768</button>
              <button class="btn" data-size="1200x800">1200×800</button>
            </div>
          </div>
          
          <div class="control-group">
            <label>Zoom</label>
            <div class="btn-group">
              <button class="btn" id="zoomOut">-</button>
              <button class="btn" id="zoomReset">100%</button>
              <button class="btn" id="zoomIn">+</button>
            </div>
          </div>

          <div class="control-group">
            <label>Actions</label>
            <div class="btn-group">
              <button class="btn" id="undo" title="Undo (Ctrl+Z)">Undo</button>
              <button class="btn" id="redo" title="Redo (Ctrl+Y/Ctrl+Shift+Z)">Redo</button>
            </div>
            <button class="btn" id="clear" style="margin-top: 8px; width: 100%;">Clear Canvas</button>
          </div>
          <label style="margin-left: 10px; user-select: none;" class="pixel-controls">
            <input type="checkbox" id="gridToggle" checked>
            Grid
          </label>
        </div>
      </div>

      <div class="panel pixel-controls">
        <div class="panel-header">
          Sprites <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group">
            <label>Current Sprite</label>
            <select id="spriteSelector"></select>
          </div>
          
          <div class="btn-group">
            <button class="btn" id="newSprite">New</button>
            <button class="btn" id="duplicateSprite">Duplicate</button>
            <button class="btn" id="deleteSprite">Delete</button>
          </div>
        </div>
      </div>

      <div class="panel sketch-controls" style="display: none;">
        <div class="panel-header">
          Layers <span>▼</span>
        </div>
        <div class="panel-content">
          <div class="control-group">
            <label>Layers</label>
            <div id="layerList" class="layer-list">
              </div>
          </div>
          <div class="control-group">
            <label>Layer Opacity: <span id="layerOpacityLabel">100</span>%</label>
            <input type="range" id="layerOpacity" min="0" max="100" value="100">
          </div>
          
          <div class="control-group">
            <label>Blend Mode</label>
            <select id="blendMode">
              <option value="source-over">Normal</option>
              <option value="multiply">Multiply</option>
              <option value="screen">Screen</option>
              <option value="overlay">Overlay</option>
              <option value="darken">Darken</option>
              <option value="lighten">Lighten</option>
              <option value="color-dodge">Color Dodge</option>
              <option value="color-burn">Color Burn</option>
              <option value="hard-light">Hard Light</option>
              <option value="soft-light">Soft Light</option>
              <option value="difference">Difference</option>
              <option value="exclusion">Exclusion</option>
            </select>
          </div>
          
          <button class="btn" id="addLayer" style="width: 100%; margin-top: 8px;">Add Layer</button>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header">
          Export/Import <span>▼</span>
        </div>
        <div class="panel-content">
          <label>Export Project</label>
          <div class="btn-group">
            <button class="btn primary" id="exportJSON">JSON (Project)</button>
            <button class="btn" id="exportPNG2">PNG (Image)</button>
          </div>
          
          <div class="export-area">
            <textarea id="output" placeholder="Export data appears here..." style="display: none;"></textarea>
            <label for="importFile" style="margin-top: 15px; display: block;">Import Project (.json)</label>
            <input type="file" id="importFile" accept=".json" style="margin-top: 8px;">
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./editor.js"></script>

</body>
</html>
